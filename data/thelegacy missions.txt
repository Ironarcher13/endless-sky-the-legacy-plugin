# Copyright (c) 2020 by Ralf Franken
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.  See the GNU General Public License for more details.

mission "The Legacy: Treasure Hunters 1"
	name "The Legacy: Treasure hunters"
	description "Transport a group of treasure hunters to the event where the legacy of legendary 'Rhon the Traveller' will be disclosed."
	deadline
	cargo "(reserved)" 10
	passengers 4
	minor
	to offer
		has "free worlds plot completed"
		has "There Might Be Riots part 3B: done"
		has "Wanderers Hai Assistance 2: done"
		has "Wanderers: Sestor: Final: done"
		has "Remnant: Salvage 6: done"
		has "Rim Archaeology 6: declined"
		has "Smuggler's Den: Follow Up: failed"
		not "event: the legacy was aborted"
	source
		attributes "paradise"
	destination "Tinker"
	on offer
		conversation
			`While enjoying some food in a rather posh spaceport restaurants, you notice a group of 4 secretive elder gentlemen at a nearby table. One of the men keeps looking at you and finally gets up and comes over to your table.`
			`	"Sorry for the interruption, sir. Aren't you <first> <last>, the starship captain who played a vital role in the archeological discoveries on Zug?"`
			choice
				`"Yes, that's me"`
			`"In that case, you may be just the person we are looking for."`
			`	He introduces himself: "I am Benoit, and over there are my friends Sherlock, Hercule and Stephan. We are looking for a trustworthy and reliable captain who will transport us on a rather delicate and dangerous mission."`
			`	He looks at you rather conspicously and whispers: "We will solve the mystery of 'Rhon the Traveller'!"`
			`	You have no idea who Rhon the Traveller is, but the fancy restaurant and the impression that Benoit and his friends leave indicate that this could be a rather lucrative opportunity.`
			choice
				`	"Okay, tell me more."`
					goto "tell me more"
				`	"Who is Rhon the Traveller?"`
				`	"Sorry, but I am not interested"`
					goto "not interested 1"
			`Benoit looks surprised, but then explains: "Rhon the Traveller was a famous philosopher, philantropist and teacher. And stinkingly rich, if I may say so."`
			label "tell me more"
			`	"When Rhon died almost a year ago, everybody was wondering what would happen to his significant inheritence."`
			`	He smiles and continues: "It turns out he left the vast part of it to 'whomever is worthy by solving the clues I have laid out'. How typical of him."`
			`	Looking at his friends he finishes: "Rhon was quite a genius, so solving his puzzles is going to be tough, but that is exactly the challenge that my friends and I enjoy."`
			choice
				`	"Sounds interesting. What would I have to do?"`
				`	"I'm sorry, but I am not really interested into chasing phantoms."`
					goto "not interested 1"
			`"Well, you would have to take us to the legacy disclosure, where all intersted parties receive the first clue. This will be in the Kugel system and we will pay you <payment> just to take us there."`
			`	With a smile he continues: "After that, it depends on where the clues will take us. I would not be surprised if this will become a chase through the entire known galaxy. And maybe even beyond..."`
			`	His expression becomes earnest.`
			`	"I fear, it will also draw attention from some rather unpleasant and violent subjects. Therefore, you and your ship must be up to the task."`
			choice
				`	"So far, so good. But what is in it for me?"`
				`	"Sorry, but this sounds rather dubious to me. You have to look for someone else."`
					goto "not interested 1"
			`"Well, we will pay you for all your costs, no matter the outcome. But what might really pique your interest - Rhon's ship is also part of the inheritance. Since none of my group has any use for such a device, the ship would be yours, in case we succeed. That and 5 percent of the rest of the inheritance."`
			choice
				`	"That surely sounds interesting. Count me in"`
					goto "count me in"
				`	"Give me the ship and 10 percent and we have a deal"`
				`	"I'm sorry, but that sounds a bit too risky for me."`
					goto "not interested 1"
			`He considers your offer for a moment and then reaches a decision. `
			label "count me in"
			`	Benoit ceremoniously shakes your hand. "We have a deal. Could you please bring us to Tinker in the Diphda system first, where we will pick up some equipment. Oh, and you better hurry up, we don't want to be late to the event!"`
				accept
			label "not interested 1"
			`"Ah, that's too bad."`
			`He turns around and walks back to his table.`
				decline
	on accept
		event "the legacy disclosure pending"
		log `Took on a group of treasure hunters and will help them chase the legacy of someone called 'Rhon the Traveller'.`
	on decline
		event "the legacy was aborted"
		event "the legacy abortion message" 180
	on fail
		dialog `You did not reach the destination on time. Your party is very angry and arranges for alternative transportation."`
		event "the legacy was aborted"
		event "the legacy abortion message" 180
	on complete
		payment 500000
		conversation
			`The four treasure hunters disembark to seek out their contacts. You agree to meet them in the Spaceport in 3 hours.`

mission "The Legacy: Treasure Hunters 2"
	name "The Legacy: Treasure hunters"
	description "Transport a group of treasure hunters to the event where the legacy of legendary 'Rhon the Traveller' will be disclosed."
	autosave
	deadline 3 0
	cargo "(reserved)" 10
	passengers 4
	to offer
		has "The Legacy: Treasure Hunters 1: done"
		not "event: the legacy was aborted"
	source "Tinker"
	destination "Legacy Disclosure site"
	on offer
		conversation
			`When you look for your passengers in the Spaceport, they are easy to spot. Each of them pulls a wagon full of electronic equipment.`
			`	You recognise some of the latest analysis computers and wonder how much money they spent on these devices. `
			`	Benoit greets you: "So, are you ready for the flight to the Kugel system?"`
			`	You cannot help but wonder: "Indeed, I am. However, you are aware that the Kugel system is an uninhabited system with no planets to land upon?"`
			`	He smiles at you. "And that is exactly the reason why Rhon chose it. Rhon always aimed for the special and the suprising. Just take us to the system and you will see. Oh, and make sure we arrive there in 3 days, else we are going to miss the big moment!"`
				accept
	on enter "Kugel"
		dialog `When you enter the <system> system, you notice hundred of ships in the system. They all converge towards a small asteroid.`
		dialog `	To your surprise your computer indicates that you can land on the asteroid.`
		dialog `	You queue up and after several hours of waiting, you finally get the permission to land.`
	on fail
		dialog `You did not reach the destination on time. Your party is very angry and arranges for alternative transportation."`
		event "the legacy was aborted"
		event "the legacy abortion message" 180
	on complete
		conversation
			`The landing platforms on the asteroid facility are busier than a beehive. You send the treasure hunters on their way.`
			`	"Good luck with the hunt. I am sorry, but I will have to depart again, I am only allowed to block the landing slot for 15 minutes"`
			`	Benoit nods. "That is okay, Captain <last>. But please make sure you stay in the system until we call for you."`

mission "The Legacy: Hang around"
	landing
	invisible
	to offer
		has "The Legacy: Treasure Hunters 2: done"
	destination "Legacy Disclosure site"
	npc disable
		government "Test Dummy"
		system "Kugel"
		personality unconstrained heroic nemesis
		ship "Timer Ship" "Timer"
		conversation
			`After what seems like an eternity, Benoit is finally hailing you.`
			`	"Please return to the landing site and pick us up."`
			`	You respond: "I am on my way, but I may get stuck in traffic again."`
			`	And indeed, it takes you 3 hours to finally get the landing permission`
	on enter "Bellatrix"
		dialog `You have left the system and missed the moment when your party wanted to depart. You receive a message from Benoit: "Captain <last>, we are rather disappointed in you. We have now arranged for alternative transportation. Your services are no longer required!"`
		event "the legacy was aborted"
		event "the legacy abortion message" 180
		fail
	on enter "Menkar"
		dialog `You have left the system and missed the moment when your party wanted to depart. You receive a message from Benoit: "Captain <last>, we are rather disappointed in you. We have now arranged for alternative transportation. Your services are no longer required!"`
		event "the legacy was aborted"
		event "the legacy abortion message" 180
		fail
	on enter "Algol"
		dialog `You have left the system and missed the moment when your party wanted to depart. You receive a message from Benoit: "Captain <last>, we are rather disappointed in you. We have now arranged for alternative transportation. Your services are no longer required!"`
		event "the legacy was aborted"
		event "the legacy abortion message" 180
		fail
	on enter "Diphda"
		dialog `You have left the system and missed the moment when your party wanted to depart. You receive a message from Benoit: "Captain <last>, we are rather disappointed in you. We have now arranged for alternative transportation. Your services are no longer required!"`
		event "the legacy was aborted"
		event "the legacy abortion message" 180
		fail
	on enter "Acamar"
		dialog `You have left the system and missed the moment when your party wanted to depart. You receive a message from Benoit: "Captain <last>, we are rather disappointed in you. We have now arranged for alternative transportation. Your services are no longer required!"`
		event "the legacy was aborted"
		event "the legacy abortion message" 180
		fail
	on enter "Elnath"
		dialog `You have left the system and missed the moment when your party wanted to depart. You receive a message from Benoit: "Captain <last>, we are rather disappointed in you. We have now arranged for alternative transportation. Your services are no longer required!"`
		event "the legacy was aborted"
		event "the legacy abortion message" 180
		fail

mission "The Legacy: Treasure Hunters 3"
	name "The Legacy: Treasure hunters"
	description "Transport a group of treasure hunters to the event where the legacy of legendary 'Rhon the Traveller' will be disclosed."
	cargo "(reserved)" 10
	passengers 4
	landing
	to offer
		has "The Legacy: Hang around: done"
		not "event: the legacy was aborted"
	source "Legacy Disclosure site"
	destination "Mainsail"
	on offer
		conversation
			`When you finally arrive at the landing area, your party is already waiting for you. Each of them is carrying a plastic tube with paper inside.`
			`	Benoit approaches you, waves the tube towards you and says: "Please get us out of here as fast as possible, so we can start looking at this with our equipment and without prying eyes."`
			`	You respond: "Okay, so where should I take you then?"`
			`	Benoit thinks for a moment. "Hmm... You know what, get us to mainsail. I own a small island there to which we can retreat for our studies."`
				accept
	on fail
		event "the legacy was aborted"
	on complete
		payment 500000
		event "the legacy disclosure done"
		conversation
			`Benoit directs you to land on his private island. You drop the party and their equipment off and then transfer the <ship> to the official spaceport.`
			`	You notice that Benoit transferred another 500000 credits to your account.`
			`	Before departure, he requested that you get in touch with him via the Spaceport.`

mission "The Legacy: Treasure Hunters 4"
	name "The Legacy: Treasure hunters"
	description "Support the treasure hunters in their chase for the legacy of 'Rhon the Traveller'."
	deadline 12 0
	cargo "(reserved)" 5
	stopover "Vinci"
	to offer
		has "The Legacy: Treasure Hunters 3: done"
		not "event: the legacy was aborted"
	source "Mainsail"
	destination "Mainsail"
	on offer
		conversation
			`When you call Benoit, he seems to be in deep thoughts. "Ah, Captain <last>. This seems to be more of a challenge than we imagined. Could you pick up some additional supplies for us on <stopovers>? And we would need them before <day>."`
			choice
				`"Sure, I'd be happy to."`
					goto "okay"
				`"Sorry, but I had enough of this."`
					goto "had enough"
			label "okay"
			`You prepare your ship for the trip to <stopovers>.`
				accept
			label "had enough"
			`"Ah, sorry to hear that. We had become rather fond of your services, but in that case we will find someone else." He hangs up.`
				decline
	on decline
		event "the legacy was aborted"
		event "the legacy abortion message" 180
	on fail
		dialog
			`You did not reach the destination on time. Benoit is very angry and terminates the collaboration."`
		event "the legacy was aborted"
		event "the legacy abortion message" 180
	on complete
		payment 500000
		conversation
			`When you land on his island, Benoit welcomes you.`
			`	"I hope they did not bother you too much about these computers. They can be a bit whimsical when it comes to their latest equipment."`
			choice
				`"No, it was fine."`
					goto "just fine"
				`"When they checked my credentials for the 5th time, I thought they might be overdoing it."`
			`	Benoit chuckles: "That sounds just like them."`
			label "just fine"
			`	"Well, it is excellent that we now have these computers at our disposal. Please contact me from the official spaceport once you have refreshed yourself"`
			`	You head back to your ship and transfer to the official spaceport`
			
mission "The Legacy: Treasure Hunters suppress stop"
	invisible
	landing
	to offer
		has "The Legacy: Treasure Hunters 4: active"
	source "Vinci"
	target "Mainsail"
	on offer
		conversation
			`When you reach <origin>, you are rerouted into the private spaceport of the largest CPU manufacturing company.`
			`	Your credentials are verified multiple times and the loading process is overseen by half a dozen very nervous executives.`
			`	Once the loading is completed, they usher you to take off straight away.`
				launch

mission "The Legacy: Treasure Hunters 5"
	name "The Legacy: Treasure hunters"
	description "Support the treasure hunters in their chase for the legacy of 'Rhon the Traveller'."
	deadline 4 0
	passengers 2
	stopover "Glory"
	to offer
		has "The Legacy: Treasure Hunters 4: done"
		not "event: the legacy was aborted"
	source "Mainsail"
	destination "Mainsail"
	on offer
		conversation
			`When you call Benoit, he is in a good mood. "Ah, Captain <last>! We have just finished setting up the new equipment and it seems everything is working fine."`
			`	You respond: "That is good news."`
			`	Benoit get's down to business: "To your next mission, then. Would it be possible for you to pick up my good friend Jane and her maid Marta on <stopovers> and bring her here within 4 days?"`
			choice
				`"Sure, this will be no problem."`
					goto "okay"
				`"Sorry, but I had enough of this."`
					goto "had enough"
			label "okay"
			`You prepare your ship for the trip to <stopovers>.`
				accept
			label "had enough"
			`"Ah, sorry to hear that. We had become rather fond of your services, but in that case we will find someone else." He hangs up.`
				decline
	on decline
		event "the legacy was aborted"
		event "the legacy abortion message" 180
	on fail
		dialog
			`You did not reach the destination on time. Benoit is very angry and terminates the collaboration."`
		event "the legacy was aborted"
		event "the legacy abortion message" 180
	on complete
		payment 500000
		conversation
			`When you approach Benoit's island, he is already waiting near the landing pad. As soon as you have touched down, he rushes in to greet your passengers.`
			`	"Jane, how lovely to see you. Thank you for joining into our endeavour."`
			`	She responds: "Benoit, it is always a pleasure, and especially if I can partake in one of your adventures. You know how I love a good challenge."`
			`	They stroll off and you help Marta with the luggage. Then you decide to follow the usual procedure, take your ship to the official spaceport and to check back in on them later.`
			`	You head back to your ship and transfer to the official spaceport. Upon arriving you notice that Benoit paid you <payment>.`

mission "The Legacy: Treasure Hunters suppress stop 2"
	invisible
	landing
	to offer
		has "The Legacy: Treasure Hunters 5: active"
	source "Glory"
	target "Mainsail"
	on offer
		conversation
			`When you reach <origin>, you are once again rerouted, this time to the airfield of the Academy of Planetary Science.`
			`	Your passengers turns out to be an elderly lady and her maid. You help them to board and take off straight away.`
				launch

mission "The Legacy: Treasure Hunters 6"
	name "The Legacy: Treasure hunters"
	description "Support the treasure hunters in their chase for the legacy of 'Rhon the Traveller'."
	cargo "(reserved)" 20
	to offer
		has "The Legacy: Treasure Hunters 5: done"
		not "event: the legacy was aborted"
	source "Mainsail"
	destination "Millrace"
	on offer
		conversation
			`When you call Benoit, he seems to be a bit uncomfortable. "My dear Captain <last>. I want to be honest with you. So far, even with the latest equipment, we have been unable to make any significant progress. And while with Jane we have brought in a fresh mind, I doubt we will have any breakthrough in the near future."`
			`	You respond: "Okay, and what does that mean."`
			`	"Well, it means that I have no reason to keep you occupied anymore. Initially, we had hoped to have the first clue solved by now and that you would take us onto a big adventure. But it seems this will take much longer. There is one last errand I would ask you to run, but after that, your services are no longer required. For now!"`
			`	You feel a bit disappointed by that. You had grown fond of Benoit and his jobs provided a good and not too difficult income. "I am very sorry to hear that."`
			`	He is visibly sad. "Well, rest assured - as soon as we have something tangible, we will be in touch with you and try to employ your services again. As for the last job, I have managed to sell my old computers to a company on <destination>. Would you be willing to transport them?"`
			choice
				`"Sure, this will be no problem."`
					goto "okay"
				`"Sorry, but we might as well severe our relationship once and for all."`
					goto "had enough"
			label "okay"
			`While you pick up the old computers, Benoit joins you on the landing platform.`
			`	"Once again, I am very sorry, but I have a parting gift for you."`
			`	He hands you one of the tubes with the first clue to the legacy. He smiles and says: "Here. This way you know at least what the fuzz is about and who knows - maybe you are smarter than all of us together and can make some sense of this."`
			`	Once the loading is finished, you open the tube and take out the paper inside. It is a large sheet full of lines and dots. But the random patterns do not make any sense to you.`
				accept
			label "had enough"
			`"Ah, sorry to hear that. We had become rather fond of your services, but in that case we will approach someone else in the future." He hangs up.`
				decline
	on decline
		event "the legacy was aborted"
		event "the legacy abortion message" 180
	on fail
		event "the legacy was aborted"
		event "the legacy abortion message" 180
	on complete
		payment 1000000
		dialog `After you have unloaded the cargo, you notice that Benoit has paid you <payment> for the delivery.`

mission "The Legacy: The First Clue 1"
	name "The Legacy: The First Clue"
	description "After Maria and Joe have helped you to decipher the first clue, you embark on the hunt for the legacy."
	invisible
	landing
	to offer
		has "The Legacy: Treasure Hunters 6: done"
		not "event: the legacy was aborted"
	source "Millrace"
	destination "Vara K'chrai"
	on offer
		conversation
			`While walking around the spaceport, you remember that Joe and Maria are living on <origin>. They are usually happy to see you, so do you want to check up on them?`
			choice
				`	Yes, pay them a visit and see how they are doing.`
					goto "check on them"
				`	No, I have better things to do.`
					decline
			label "check on them"
			`You call them and they are very happy to hear from you. They invite you over for dinner. So you buy some gifts for the kids and a huge food basket and join them in their small appartment, to which they have moved in the meantime. You are happy to see that they are doing well.`
			`	Once the kids are in the bed, you enjoy a good bottle of wine and entertain Joe and Maria with stories from your travels. However, when you mention your latest encounter with the treasure hunters, Mariah sits up straight.`
			`	"<first>, are you serious? Do you really have a clue to the legacy of Rhon? I mean - _the_ Rhon?"`
			`	Since you had never heard of him before, you are suprised that she knows him. You tell her so.`
			`	"Of course I know him. Rhon Danperi, that's his real name. But the pirates call him 'Rhon the Rat'. He started off as a lowly pirate and quickly ascended through the ranks. Then, from one day to the next, he renounced his pirate ways and became an outcast."`
			choice
				`	"What happened then?"`
			`"Well, he was wanted in most known systems and now the pirates were also after him. So, he did the only thing he could - he disappeared. No one knows where to, though."`
			`	"Twenty years later, he resurfaced. Since he had never killed anyone during his raids, he was no longer wanted by the law. So, he travelled through the systems and tried to make amends for what he had done in the past by helping."`
			`	"He also spread his message of peace. He quickly became popular amongst the poor, but also administration listen to his advice. He was a very smart man."`
			choice
				`	"What about then Pirates, though?"`
			`"You are right. The Pirates never forget and there was still a large bounty on his head. Several gangs tried to cash in, but it did them no good. Rhon never attacked, but those who went up against him, he destroyed without mercy."`
			`	"His ship could not be touched by anything build in human space. Rumor says he had filled it with alien technology. In the end, they left him alone. Turned him into a scare for little children."`
			choice
				`	"Wow, where do you know this from?"`
			`"They scared me with his name when I was little. But I don't like being scared, so I started digging and found out the complete story."`
			`	"It was actually his story which expired us to run off for a better life back then when we met you on Smuggler's Den."`
			`	You are fascinated by Maria's story and resolve to do some research of your own into this Rhon.`
			choice
				`	Offer Maria and Joe to show them the clue you have received from Benoit`
					goto "show it"
				`	Change the subject.`
			`You express your admiration for Maria's story and then change the subject. You enjoy the rest of your evening together and then return to your ship.`
				decline
			label "show it"
			`Upon hearing your offer, there is no stopping Maria. Joe smiles knowingly. Maria heads over to their neighbours and makes sure they watch over the kids. Then you are off to the Spaceport.`
			`	In the ship, you hand Maria the paper with the lines and dots. She takes a look at it and then begins to smile.`
			`	"<first>, can we have front and backpage scanned and then projected on each other?"`
			`	You perform the scans and bring them up on a holo screen.`
			`	"Joe, do you still recall Rhon's coat of arms?"`
			`	Joe paints a pattern onto a different corner of the screen. Maria makes some small adjustments and then resizes and projects it on top of the pattern scan. Then she cuts out three triangular portions.`
			`	"It must be these, already in his pirate days Rhon was obsessed with the number 3."`
			choice
				`	"That's right. The first clues were actually handed out 333 days after his death."`
			`Maria nods absently. She turns and overlaps the triangles and then flips the pieces until suddently the previously chaotic patterns connect and form a set of symbols.`
			`	Maria seems disappointed though. "That's an old pirate trick to encode informations, unless you know the areas and angles even the smartest computers will have trouble decoding this. However, those symbols mean absolutely nothing to me."`
			`	Now it is your turn to be excited. "They do to me. This looks like Hai writing. You have just solved the first clue."`
			`	Maria and Joe look confused. "Who are the Hai?"`
			`	"They are an alien race which I have met during my travels. "`
			choice
				`	I cannot read those symbols myself and to have them deciphered, I need to travel to the other side of a wormhole."`
			`You store a copy of the symbols on a data crystal and erase all traces of your discovery. You return with Joe and Maria to their home and spend the rest of the evening wondering about what is to come.`
			`	When it's time to leave, they wish you good luck for your adventure. You promise to give them a share if your hunt is successful.`
			`Back on your ship, you start educating yourself about Rhon, his live and his teachings, and find that he was indeed a fascinating person. You feel that you are drawn into this adventure more than you intended. You decide to embark on the first step of the journey tomorrow.`
			`	You may have overdone it with your studies, tough. In your sleep you dream of Rhon visiting you.`
			`	He gives you a warning: "If you want to find my inheritance, your mission computer will not be helping you. All you have at your disposal is your knowledge of the galaxy and the friends you have made."`
				accept
	on decline
		event "the legacy was aborted"
	on fail
		event "the legacy was aborted"
		event "the legacy abortion message" 180
	on complete
		dialog `Hai will help to decipher`

mission "The Legacy: Hai not helping 1"
	landing
	source 
		government "Hai"
		not planet "Hai-home"
	to offer
		has "The Legacy: The First Clue 1: active"
	on offer
		conversation
			`You go to the information desk and show some of the symbols.`
			`	To your surprise the Hai gets angry and tells you: "No one here will help you. Go away!"`
				decline

mission "The Legacy: Hai not helping 2"
	landing
	source "Hai-home"
	to offer
		has "The Legacy: The First Clue 1: active"
	on offer
		conversation
			`Since you have a good standing with the Hai, you are welcome by an official. You show him the symbols. He looks at you in what you assume is a puzzled way.`
			`	"These symbols are sacred to the Hai. You should not even possess these. You are a good friend to the Hai, so I will not ask you how you got this. But their meaning may not be disclosed, that is a sacred law."`
			`	It looks like you will have no success through official channels. Maybe you should talk to someone you know personally.`
				decline

mission "The Legacy: Muahaha"
	landing
	to offer
		has "event: the legacy abortion message"
	on offer
		conversation
			`When you enter the spaceport you notice the latest news. The mystery around the legacy of Rhon the Traveller was finally solved. It was discovered in a previously unknown area of space and contained a new type of spaceship and immense riches. You briefly recall that you had a chance to participate...`
				decline
